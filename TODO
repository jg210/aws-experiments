* Update DNS record on startup.
  - IP address changes on each restart.
  - can get IP address using curl http://169.254.169.254/latest/meta-data/public-ipv4
  - store password in SSM and install to file using e.g. CloudFormation::Init
    - is that secure?
      - user data can be read using http://169.254.169.254/latest/user-data
    - how would password be changed?
  - expose to all users in EC2 instance using IAM roles
    - e.g. https://www.honeybadger.io/blog/managing-secrets-in-ec2/
    - but only one unix user needs to know that password
  - https://docs.aws.amazon.com/systems-manager/latest/userguide/ssm-agent.html
    - running in the ubuntu AMI I am using.
  - set up an Elastic IP address instead?
    => can send IP at install time and amazon never needs to know the password
    - pay for Elastic IP address unless use all of free-tier EC2 allowance
      keeping an instance running.
      - ~$100 a year for t2.micro

* user-data script is not viable way to provision instance
  - not run on stack update.

* Publish Spring app to S3.

* Deploy and start Spring app.

* Configure https cert.

* Automate package updates.

* Wait for server to start up before declaring EC2/stack deployment complete.

* Redirect http to https.

* Configure Elastic IP address
  - free when are using it
  - would reduce number of times need to update DNS record
  - would presumbly have to configure public IP address on instance network interface,
    not via the default on the subnet?

* NTP
  - ntp.ubuntu.com inaccessible from the EC2 instance.
    - errors in syslog
  - amazon provide 169.254.169.123
    - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/set-time.html

* EC2 cloudformation config only allows one ssh public key per instance...
  - https://stackoverflow.com/questions/24409095/create-an-ec2-instance-with-multiple-key-pairs
  - so how are you supposed to log in from multiple home directories?
    - sharing a private key is not acceptable, especially not between users.
    - using parameter means could have one instance per ssh key, but that's not useful.
    - reupload key each time change home directories?
    - generate new key each time deploy instance, throwing away as soon as have provisioned instance properly.
    - build and deploy AMI containing public keys

* Staging and production environments?

* Automated deployments.
  - would need to do things like this to have python and ruby in travis.
    - https://github.com/travis-ci/travis-ci/issues/4090
  - a docker-based testing platform would be more convenient.
  - generate change set on branches don't deploy from.

* Wrap environment setup in scripts.

* Tighten up egress permissions.

* Static analysis.
  X cfn_nag.
  - run aws cloudformation validate-template from travis.
  - https://github.com/Skyscanner/cfripper too?
